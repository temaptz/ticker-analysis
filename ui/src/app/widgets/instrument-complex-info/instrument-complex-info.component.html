@defer (when isLoaded()) {
  <ng-container *ngIf="instrument() as instr">

    <div class="flex align-items-center">
      <instrument-logo [instrumentUid]="instr.uid"></instrument-logo>

      <h3>[{{ instr.ticker }}] - {{ instr.name }}</h3>

      <span class="price">(<current-price #priceComponent [instrumentUid]="instr.uid"></current-price>)</span>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <h5>Фундаментальные показатели</h5>

            <fundamentals
              *ngIf="instr.asset_uid as asset_uid"
              [instrumentAssetUid]="asset_uid"
            ></fundamentals>
          </td>
          <td>
            <h5>Прогноз аналитиков + история</h5>

            <forecast
              [instrumentUid]="instr.uid"
            ></forecast>
            <br>
            <br>
            <forecast-history
              [instrumentUid]="instr.uid"
            ></forecast-history>
          </td>
          <td>
            <h5>Прогноз TA-1</h5>

            <prediction
              [instrumentUid]="instr.uid"
            ></prediction>
          </td>
        </tr>

        <tr>
          <td>
            <h5>Баланс Аналитический</h5>

            <ng-container *ngIf="priceComponent.price() as currentPrice">
              <balance
                *ngIf="instrument()?.figi as figi"
                accountName="Аналитический"
                [instrumentUid]="instr.uid"
                [instrumentFigi]="figi"
              ></balance>
            </ng-container>
          </td>
          <td>
            <h5>Баланс Основной</h5>

            <ng-container *ngIf="priceComponent.price() as currentPrice">
              <balance
                *ngIf="instrument()?.figi as figi"
                accountName="Основной"
                [instrumentUid]="instr.uid"
                [instrumentFigi]="figi"
              ></balance>
            </ng-container>
          </td>
          <td>
            <h5>Новости</h5>

            <news
              [instrumentUid]="instr.uid"
            ></news>
          </td>
        </tr>

        <tr>
          <td colspan="3">
            <h5>История за 3 года</h5>

            <div class="graph-container">
              <graph
                width="100%"
                height="300px"
                [instrumentUid]="instr.uid"
                [days]="365 * 3"
                [interval]="candleInterval.CANDLE_INTERVAL_WEEK"
              ></graph>
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="3">
            <h5>История за {{ complexGraphHistoryDaysCount }} дней + история прогнозов TA-1</h5>

            <div class="graph-container">
              <complex-graph
                width="100%"
                height="300px"
                [instrumentUid]="instr.uid"
                [historyDays]="complexGraphHistoryDaysCount"
              ></complex-graph>

              <select [(ngModel)]="complexGraphHistoryDaysCount">
                <option [value]="30">30 дней</option>
                <option [value]="60">60 дней</option>
                <option [value]="90">90 дней</option>
                <option [value]="120">120 дней</option>
                <option [value]="180">180 дней</option>
                <option [value]="210">210 дней</option>
                <option [value]="240">240 дней</option>
                <option [value]="270">270 дней</option>
                <option [value]="300">300 дней</option>
              </select>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </ng-container>
}
@placeholder {
  <preloader></preloader>
}
