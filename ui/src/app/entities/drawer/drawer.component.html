<div
  class="toggler"
  (click)="handleToggleDrawer()"
>üõ†</div>

<div
  class="drawer"
  [class.hidden]="!isDrawerOpen()"
>
  <div class="sort-section">
    <p class="sort-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</p>
    <div class="sort-buttons">
      <button class="sort-btn" [class.active]="sort() === sortModeEnum.BuyPerspective" (click)="setSort(sortModeEnum.BuyPerspective)">–ü–æ–∫—É–ø–∫–∞</button>
      <button class="sort-btn" [class.active]="sort() === sortModeEnum.SellPerspective" (click)="setSort(sortModeEnum.SellPerspective)">–ü—Ä–æ–¥–∞–∂–∞</button>
      <button class="sort-btn" [class.active]="sort() === sortModeEnum.LastOperation" (click)="setSort(sortModeEnum.LastOperation)">–ü–æ—Å–ª–µ–¥–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏—è</button>
      <button class="sort-btn" [class.active]="sort() === sortModeEnum.MarketValue" (click)="setSort(sortModeEnum.MarketValue)">–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyTotalRate" (click)="setSort(sortModeEnum.BuyTotalRate)">–ò—Ç–æ–≥</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellTotalRate" (click)="setSort(sortModeEnum.SellTotalRate)">–ò—Ç–æ–≥</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyMacd" (click)="setSort(sortModeEnum.BuyMacd)">MACD</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellMacd" (click)="setSort(sortModeEnum.SellMacd)">MACD</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyRsi" (click)="setSort(sortModeEnum.BuyRsi)">RSI</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellRsi" (click)="setSort(sortModeEnum.SellRsi)">RSI</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyTech" (click)="setSort(sortModeEnum.BuyTech)">–¢–µ—Ö.</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellTech" (click)="setSort(sortModeEnum.SellTech)">–¢–µ—Ö.</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyNews" (click)="setSort(sortModeEnum.BuyNews)">–ù–æ–≤–æ—Å—Ç–∏</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellNews" (click)="setSort(sortModeEnum.SellNews)">–ù–æ–≤–æ—Å—Ç–∏</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyFundamental" (click)="setSort(sortModeEnum.BuyFundamental)">–§—É–Ω–¥–∞–º.</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellFundamental" (click)="setSort(sortModeEnum.SellFundamental)">–§—É–Ω–¥–∞–º.</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyProfit" (click)="setSort(sortModeEnum.BuyProfit)">–ü—Ä–∏–±—ã–ª—å</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellProfit" (click)="setSort(sortModeEnum.SellProfit)">–ü—Ä–∏–±—ã–ª—å</button>
      <button class="sort-btn sort-btn--buy" [class.active]="sort() === sortModeEnum.BuyVolume" (click)="setSort(sortModeEnum.BuyVolume)">–û–±—ä—ë–º</button>
      <button class="sort-btn sort-btn--sell" [class.active]="sort() === sortModeEnum.SellVolume" (click)="setSort(sortModeEnum.SellVolume)">–û–±—ä—ë–º</button>
    </div>
  </div>

  @if (totalInfo.hasValue()) {
    @let info = totalInfo.value();

    <div class="total-info">
      <h5>–û—Ü–µ–Ω–µ–Ω–æ {{ weekPercent() }}% ({{ info!.news_week_rated_count }} / {{ info!.news_week_count }}) –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ –Ω–µ–¥–µ–ª—é</h5>
      <div class="bar">
        <div [style.width.%]="weekPercent()"></div>
      </div>

      <h5>–û—Ü–µ–Ω–µ–Ω–æ {{ monthPercent() }}% ({{ info!.news_month_rated_count }} / {{ info!.news_month_count }}) –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ –º–µ—Å—è—Ü</h5>
      <div class="bar">
        <div [style.width.%]="monthPercent()"></div>
      </div>

      <h5>–û—Ü–µ–Ω–µ–Ω–æ {{ totalPercent() }}% ({{ info!.news_total_rated_count }} / {{ info!.news_total_count }}) –Ω–æ–≤–æ—Å—Ç–µ–π –≤—Å–µ–≥–æ</h5>
      <div class="bar">
        <div [style.width.%]="totalPercent()"></div>
      </div>
    </div>
  }

  <weights-editor />

  <complex-graph-control
    [historyDaysCount]="graphSettings().historyDaysCount"
    [interval]="graphSettings().interval"
    [futureDaysCount]="graphSettings().futureDaysCount"
    [isShowNews]="graphSettings().isShowNews"
    [isShowTa_1_PredictionsHistory]="graphSettings().isShowTa_1_PredictionsHistory"
    [isShowTa_1_1_PredictionsHistory]="graphSettings().isShowTa_1_1_PredictionsHistory"
    [isShowTa_1_2_PredictionsHistory]="graphSettings().isShowTa_1_2_PredictionsHistory"
    [isShowTa_2_PredictionsHistory]="graphSettings().isShowTa_2_PredictionsHistory"
    [isShowTa_2_1_PredictionsHistory]="graphSettings().isShowTa_2_1_PredictionsHistory"
    [isShowModels]="graphSettings().isShowModels"
    [isShowForecasts]="graphSettings().isShowForecasts"
    (onChange)="handleChangeGraphSettings($event)"
  />
</div>
